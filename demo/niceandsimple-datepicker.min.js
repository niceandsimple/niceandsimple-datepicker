"use strict";angular.module("niceandsimpleDatepicker",["componentsTemplates"]),angular.module("niceandsimpleDatepicker").directive("niceandsimpleDatepickerScroll",["moment","$document","$timeout",function(t,e,n){return{restrict:"E",templateUrl:"/src/niceandsimpleDatepicker/directives/scroll/template.html",scope:{},bindToController:{date:"="},controllerAs:"datepickerScrollCtrl",controller:function(){var e=this;this.monthListLength=48,this.updateMonthIndex=18,this.selectDate=function(t){e.date=t},this.getMonthsList=function(n){n=n.startOf("month")||t().startOf("month");for(var i=[],r=0;r<e.monthListLength;r++)r<e.monthListLength/2?i.push(t(n).subtract(e.monthListLength/2-r,"months")):r>e.monthListLength/2?i.push(t(n).add(r-e.monthListLength/2,"months")):i.push(t(n));return i},this.currentMonth=t()},link:function(e,i,r,a){function o(){var t=document.createElement("div"),e=0;return t.style.position="absolute",t.style.left="-500px",t.style.width="100px",t.style.visibility="hidden",t.style.overflow="scroll",document.body.appendChild(t),e=t.offsetWidth-t.clientWidth+1,t.remove(),e}function c(t){return"datepicker-month-"+t.format("MM-YYYY")}function l(t){return document.getElementById(c(t))}function s(t){var e=l(t);return e.getBoundingClientRect().top-p[0].getBoundingClientRect().top}function d(t){var e=l(t);return e.getBoundingClientRect().bottom-e.getBoundingClientRect().top}function m(i){u||(h=p[0].scrollTop,u=!0,n(function(){if(p[0].scrollTop<h){var i=t(a.currentMonth).subtract(a.updateMonthIndex,"months");if(0<=s(i)){var r=a.getMonthsList(i),o=0;e.$apply(function(){a.currentMonth=i,a.months=r}),n(function(){for(var t=0;t<a.updateMonthIndex;t++)o+=d(r[t]);p[0].scrollTop+=o},0,!1)}}else{var c=t(a.currentMonth).add(a.updateMonthIndex,"months");if(s(c)<0){var o=0;e.$apply(function(){a.currentMonth=c,a.months=a.getMonthsList(a.currentMonth)}),n(function(){for(var t=0;t<a.updateMonthIndex;t++)o+=d(a.months[a.months.length-t-1]);p[0].scrollTop-=o},0,!1)}}u=!1},350,!1))}var p=angular.element(i[0].querySelector(".months-list"));p[0].style.marginRight=-o()+"px";var u=!0,h=0;p.on("scroll",m),e.$watch(function(){return a.date},function(e){var i=t(e).startOf("month")||t().startOf("month");a.currentMonth=i,a.months=a.getMonthsList(i),n(function(){p[0].scrollTop=0,p[0].scrollTop=s(i)},0,!1),u=!1})}}}]),angular.module("niceandsimpleDatepicker").directive("niceandsimpleDatepickerMonth",["moment",function(t){return{restrict:"E",scope:{},templateUrl:"/src/niceandsimpleDatepicker/directives/month/template.html",bindToController:{date:"=",selectDate:"&?",selectedDate:"=?"},controllerAs:"datepickerMonthCtrl",controller:function(){},link:function(e,n,i,r){function a(e){e=e||t();var n={list:[],firstDayOffset:0},i=e.daysInMonth(),r=t(e).date(1).day();1==o&&(r=r>0?r-1:6);for(var a=0;i>a;a++){var l=t(e).date(a+1),s=l.day();1==o&&(s=s>0?s-1:6),n.list.push({value:l,isToday:t().isSame(l,"day"),isSelected:c?c.isSame(l,"day"):!1,isWeekend:s>4?!0:!1}),0==a&&r>0&&(n.firstDayOffset=r)}return n}var o=1,c=null;e.$watch(function(){return r.date},function(n,i){e.days=a(t(n))}),e.$watch(function(){return r.selectedDate},function(e,n){c=t(e)})}}}]),angular.module("niceandsimpleDatepicker").directive("niceandsimpleDatepicker",["moment",function(t){return{restrict:"E",templateUrl:"/src/niceandsimpleDatepicker/directives/datepicker/template.html",require:"ngModel",link:function(t,e,n,i){t.$watch(function(){return i.$modelValue},function(e,n){t.date=e}),t.$watch("date",function(t,e){t!=e&&(i.$setViewValue=t,i.$render())})}}}]),angular.module("niceandsimpleDatepicker").directive("datepickerControls",function(){return{}}),angular.module("componentsTemplates",[]).run(["$templateCache",function(t){t.put("/src/niceandsimpleDatepicker/directives/controls/template.html",""),t.put("/src/niceandsimpleDatepicker/directives/datepicker/template.html",'<input ng-model="date"/><niceandsimple-datepicker-scroll date="date"></niceandsimple-datepicker-scroll>'),t.put("/src/niceandsimpleDatepicker/directives/month/template.html",'<div ng-class="days.firstDayOffset ? \'day-start-offset-\' + days.firstDayOffset : \'\'" class="month-label">{{ datepickerMonthCtrl.date.format("MMMM\'YY") }}</div><div ng-repeat="day in days.list track by $index" ng-class="{\'is-today\': day.isToday, \'is-disabled\': day.isDisabled, \'is-weekend\': day.isWeekend, \'is-selected\': day.isSelected}" ng-click="datepickerMonthCtrl.selectDate({date: +day.value})" class="day"><span class="day-label">{{ day.value.format(\'D\') }}</span></div>'),t.put("/src/niceandsimpleDatepicker/directives/scroll/template.html",'<div class="viewport"><div class="months-list"><div ng-repeat="month in datepickerScrollCtrl.months track by $index | limitTo:datepickerScrollCtrl.monthListLength" id="datepicker-month-{{ month.format(\'MM-YYYY\') }}" class="month-item"><niceandsimple-datepicker-month date="month" select-date="datepickerScrollCtrl.selectDate(date)" selected-date="datepickerScrollCtrl.date"></niceandsimple-datepicker-month></div></div></div>')}]);